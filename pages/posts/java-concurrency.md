---
title: Java å¹¶å‘ç¼–ç¨‹åŸºç¡€
categories: Java
tags:
  - åç«¯
  - Java
  - å¤šçº¿ç¨‹
---


## è¿›ç¨‹ä¸çº¿ç¨‹




### è¿›ç¨‹
- ç¨‹åºç”±æŒ‡ä»¤å’Œæ•°æ®ç»„æˆï¼Œä½†è¿™äº›æŒ‡ä»¤è¦è¿è¡Œï¼Œæ•°æ®è¦è¯»å†™ï¼Œå°±å¿…é¡»å°†æŒ‡ä»¤åŠ è½½è‡³ CPUï¼Œæ•°æ®åŠ è½½è‡³å†…å­˜ã€‚åœ¨æŒ‡ä»¤è¿è¡Œè¿‡ç¨‹ä¸­è¿˜éœ€è¦ç”¨åˆ°ç£ç›˜ ã€ç½‘ç»œç­‰è®¾å¤‡ã€‚**è¿›ç¨‹å°±æ˜¯ç”¨æ¥åŠ è½½æŒ‡ä»¤ã€ç®¡ç†å†…å­˜ã€ç®¡ç† IO çš„** 
- å½“ä¸€ä¸ªç¨‹åºè¢«è¿è¡Œï¼Œä»ç£ç›˜åŠ è½½è¿™ä¸ªç¨‹åºçš„ä»£ç è‡³å†…å­˜ï¼Œè¿™æ—¶å°±å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ã€‚ 
- è¿›ç¨‹å°±å¯ä»¥è§†ä¸ºç¨‹åºçš„ä¸€ä¸ªå®ä¾‹ã€‚å¤§éƒ¨åˆ†ç¨‹åºå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªå®ä¾‹è¿›ç¨‹ï¼ˆä¾‹å¦‚è®°äº‹æœ¬ã€ç”»å›¾ã€æµè§ˆå™¨ç­‰ï¼‰ï¼Œä¹Ÿæœ‰çš„ç¨‹åºåªèƒ½å¯åŠ¨ä¸€ä¸ªå®ä¾‹è¿›ç¨‹ï¼ˆä¾‹å¦‚ç½‘æ˜“äº‘éŸ³ä¹ã€360 å®‰å…¨å«å£«ç­‰ï¼‰ 
>è¿›ç¨‹å¯ä»¥ç†è§£ä¸ºç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯åŠ¨æ€çš„ï¼


### çº¿ç¨‹

- ä¸€ä¸ªè¿›ç¨‹ä¹‹å†…å¯ä»¥åˆ†ä¸ºä¸€åˆ°å¤šä¸ªçº¿ç¨‹ã€‚ 
- ä¸€ä¸ªçº¿ç¨‹å°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤æµï¼Œå°†æŒ‡ä»¤æµä¸­çš„ä¸€æ¡æ¡æŒ‡ä»¤ä»¥ä¸€å®šçš„é¡ºåºäº¤ç»™ CPU æ‰§è¡Œ 
- Java ä¸­ï¼Œçº¿ç¨‹æ˜¯æœ€å°çš„è°ƒåº¦å•ä½ï¼Œè¿›ç¨‹ä½œä¸ºèµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚ åœ¨ Windows ä¸­è¿›ç¨‹æ˜¯ä¸æ´»åŠ¨çš„ï¼Œåªæ˜¯ä½œä¸ºçº¿ç¨‹çš„å®¹å™¨


### å¯¹æ¯”
- è¿›ç¨‹åŸºæœ¬ä¸Šç›¸äº’ç‹¬ç«‹ï¼Œè€Œçº¿ç¨‹å­˜åœ¨äºè¿›ç¨‹å†…ï¼Œæ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå­é›†
- è¿›ç¨‹æ‹¥æœ‰å…±äº«çš„èµ„æºï¼Œå¦‚å†…å­˜ç©ºé—´ç­‰ï¼Œä¾›å…¶å†…éƒ¨çš„çº¿ç¨‹å…±äº«
- è¿›ç¨‹é—´é€šä¿¡è¾ƒä¸ºå¤æ‚
  - åŒä¸€å°è®¡ç®—æœºçš„è¿›ç¨‹é€šä¿¡ç§°ä¸º IPC (Inter-process communication)
  - ä¸åŒè®¡ç®—æœºä¹‹é—´çš„è¿›ç¨‹é€šä¿¡ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œï¼Œå¹¶éµå®ˆå…±åŒçš„åè®®ï¼Œä¾‹å¦‚ HTTP åè®®
- çº¿ç¨‹é€šä¿¡ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºå®ƒä»¬å…±äº«è¿›ç¨‹å†…çš„å†…å­˜ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå…±äº«å˜é‡
- çº¿ç¨‹æ›´è½»é‡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ä¸€èˆ¬è¦æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä½

### ğŸ’¡é¢è¯•é¢˜
ä»€ä¹ˆæ˜¯è¿›ç¨‹å’Œçº¿ç¨‹ï¼Ÿ

è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„åŸºæœ¬å•ä½ï¼Œå› æ­¤è¿›ç¨‹æ˜¯åŠ¨æ€çš„ã€‚ç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºï¼Œè¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚

åœ¨ Java ä¸­ï¼Œå½“æˆ‘ä»¬å¯åŠ¨ main å‡½æ•°æ—¶å…¶å®å°±æ˜¯å¯åŠ¨äº†ä¸€ä¸ª JVM çš„è¿›ç¨‹ï¼Œè€Œ main å‡½æ•°æ‰€åœ¨çš„çº¿ç¨‹å°±æ˜¯è¿™ä¸ªè¿›ç¨‹ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿç§°ä¸»çº¿ç¨‹ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ Windows ä¸­é€šè¿‡æŸ¥çœ‹ä»»åŠ¡ç®¡ç†å™¨çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¸…æ¥šçœ‹åˆ° Windows å½“å‰è¿è¡Œçš„è¿›ç¨‹ï¼ˆ.exe æ–‡ä»¶çš„è¿è¡Œï¼‰ã€‚
![](https://zzyang.oss-cn-hangzhou.aliyuncs.com/img/xw_20250811211830.png)

*ä½•ä¸ºçº¿ç¨‹?*

çº¿ç¨‹ä¸è¿›ç¨‹ç›¸ä¼¼ï¼Œä½†çº¿ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯ä»¥äº§ç”Ÿå¤šä¸ªçº¿ç¨‹ã€‚ä¸è¿›ç¨‹ä¸åŒçš„æ˜¯åŒç±»çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„**å †**å’Œ**æ–¹æ³•åŒº**èµ„æºï¼Œä½†æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„**ç¨‹åºè®¡æ•°å™¨**ã€**è™šæ‹Ÿæœºæ ˆ**å’Œ**æœ¬åœ°æ–¹æ³•æ ˆ**ï¼Œæ‰€ä»¥ç³»ç»Ÿåœ¨äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–æ˜¯åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´åšåˆ‡æ¢å·¥ä½œæ—¶ï¼Œè´Ÿæ‹…è¦æ¯”è¿›ç¨‹å°å¾—å¤šï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œçº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚

## å¹¶è¡Œä¸å¹¶å‘

å¹¶å‘æ˜¯åœ¨åŒä¸€æ—¶é—´æ®µï¼Œå¹¶è¡Œæ˜¯åœ¨åŒä¸€æ—¶åˆ»ï¼

:::tip
å¹¶å‘ï¼ˆConcurrentï¼‰ï¼šä¸€ä¸ªäººåŒæ—¶åšå¾ˆå¤šä¸åŒäº‹æƒ… 

å¹¶è¡Œï¼ˆParallelï¼‰ï¼šä¸€ç¾¤äººå„è‡ªåŒæ—¶åšå¾ˆå¤šäº‹æƒ…
:::

### å¹¶å‘
å•æ ¸ CPU ä¸‹ï¼Œçº¿ç¨‹å®é™…è¿˜æ˜¯ `ä¸²è¡Œæ‰§è¡Œ` çš„ã€‚æ“ä½œç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç»„ä»¶å«åš*ä»»åŠ¡è°ƒåº¦å™¨*ï¼Œå°† CPU çš„æ—¶é—´ç‰‡ï¼ˆwindows ä¸‹æ—¶é—´ç‰‡æœ€å°çº¦ä¸º 15 æ¯«ç§’ï¼‰åˆ†ç»™ä¸åŒçš„ç¨‹åºä½¿ç”¨ï¼Œåªæ˜¯ç”±äº CPU åœ¨çº¿ç¨‹é—´ï¼ˆæ—¶é—´ç‰‡å¾ˆçŸ­ï¼‰çš„åˆ‡æ¢éå¸¸å¿«ï¼Œäººç±»æ„Ÿè§‰æ˜¯åŒæ—¶è¿è¡Œçš„ ã€‚æ€»ç»“ä¸ºä¸€å¥è¯å°±æ˜¯ï¼š *å¾®è§‚ä¸²è¡Œï¼Œå®è§‚å¹¶è¡Œ* ã€‚

>ä¸€èˆ¬æˆ‘ä»¬ä¼šå°†è¿™ç§ *çº¿ç¨‹è½®æµä½¿ç”¨CPU* çš„åšæ³•ç§°ä¸º:  **å¹¶å‘ï¼ˆ Concurrentï¼‰**

| CPU  | æ—¶é—´ç‰‡ 1 | æ—¶é—´ç‰‡ 2 | æ—¶é—´ç‰‡ 3 | æ—¶é—´ç‰‡ 4 |
|------|----------|----------|----------|----------|
| core | çº¿ç¨‹ 1   | çº¿ç¨‹ 2   | çº¿ç¨‹ 3   | çº¿ç¨‹ 4   |

![](https://zzyang.oss-cn-hangzhou.aliyuncs.com/img/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_page7_image.png)
### å¹¶è¡Œ
å¤šæ ¸ cpuä¸‹ï¼Œæ¯ä¸ª `æ ¸ï¼ˆcoreï¼‰` éƒ½å¯ä»¥è°ƒåº¦è¿è¡Œçº¿ç¨‹ï¼Œè¿™æ—¶å€™çº¿ç¨‹å¯ä»¥æ˜¯ **å¹¶è¡Œ** çš„
| CPU | æ—¶é—´ç‰‡ 1 | æ—¶é—´ç‰‡ 2 | æ—¶é—´ç‰‡ 3 | æ—¶é—´ç‰‡ 4 |
| --- | --- | --- | --- | --- |
| core 1 | çº¿ç¨‹ 1 | çº¿ç¨‹ 1 | çº¿ç¨‹ 3 | çº¿ç¨‹ 3 |
| core 2 | çº¿ç¨‹ 2 | çº¿ç¨‹ 4 | çº¿ç¨‹ 2 | çº¿ç¨‹ 4 |

![](https://zzyang.oss-cn-hangzhou.aliyuncs.com/img/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_page8_image.png)

>åœ¨å¤šæ ¸ CPU ä¸‹å¹¶å‘å’Œå¹¶è¡Œæ˜¯åŒæ—¶å­˜åœ¨çš„ã€‚

:::info
- å¹¶å‘ï¼ˆconcurrentï¼‰æ˜¯åŒä¸€æ—¶é—´åº”å¯¹ï¼ˆdealing withï¼‰å¤šä»¶äº‹æƒ…çš„èƒ½åŠ›
- å¹¶è¡Œï¼ˆparallelï¼‰æ˜¯åŒä¸€æ—¶é—´åŠ¨æ‰‹åšï¼ˆdoingï¼‰å¤šä»¶äº‹æƒ…çš„èƒ½åŠ›
:::


ç”Ÿæ´»ä¾‹å­
- å®¶åº­ä¸»å¦‡åšé¥­ã€æ‰“æ‰«å«ç”Ÿã€ç»™å­©å­å–‚å¥¶ï¼Œå¥¹ä¸€ä¸ªäººè½®æµäº¤æ›¿åšè¿™å¤šä»¶äº‹ï¼Œè¿™æ—¶å°±æ˜¯å¹¶å‘
- å®¶åº­ä¸»å¦‡é›‡äº†ä¸ªä¿å§†ï¼Œå¥¹ä»¬ä¸€èµ·è¿™äº›äº‹ï¼Œè¿™æ—¶æ—¢æœ‰å¹¶å‘ï¼Œä¹Ÿæœ‰å¹¶è¡Œï¼ˆè¿™æ—¶ä¼šäº§ç”Ÿç«äº‰ï¼Œä¾‹å¦‚é”…åªæœ‰ä¸€å£ï¼Œä¸€ä¸ªäººç”¨é”…æ—¶ï¼Œå¦ä¸€ä¸ªäººå°±å¾—ç­‰å¾…ï¼‰
- é›‡äº†3ä¸ªä¿å§†ï¼Œä¸€ä¸ªä¸“åšé¥­ã€ä¸€ä¸ªä¸“æ‰“æ‰«å«ç”Ÿã€ä¸€ä¸ªä¸“å–‚å¥¶ï¼Œäº’ä¸å¹²æ‰°ï¼Œè¿™æ—¶æ˜¯å¹¶è¡Œ


### ğŸ’¡é¢è¯•é¢˜

å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«
- å¹¶å‘ï¼šä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„ä½œä¸šåœ¨åŒä¸€ æ—¶é—´æ®µ å†…æ‰§è¡Œ
- å¹¶è¡Œï¼šä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„ä½œä¸šåœ¨åŒä¸€ æ—¶åˆ» æ‰§è¡Œ
æœ€å…³é”®çš„ç‚¹æ˜¯ï¼šæ˜¯å¦æ˜¯ åŒæ—¶ æ‰§è¡Œ

åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«
- åŒæ­¥ï¼šå‘å‡ºä¸€ä¸ªè°ƒç”¨ä¹‹åï¼Œåœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰ï¼Œ è¯¥è°ƒç”¨å°±ä¸å¯ä»¥è¿”å›ï¼Œä¸€ç›´ç­‰å¾…ã€‚
- å¼‚æ­¥ï¼šè°ƒç”¨åœ¨å‘å‡ºä¹‹åï¼Œä¸ç”¨ç­‰å¾…è¿”å›ç»“æœï¼Œè¯¥è°ƒç”¨ç›´æ¥è¿”å›ã€‚


## çº¿ç¨‹åŸºæœ¬åº”ç”¨

### å¼‚æ­¥è°ƒç”¨

ä»æ–¹æ³•è°ƒç”¨æ–¹çš„è§’åº¦æ¥è®²ï¼Œå¦‚æœï¼š
- éœ€è¦ç­‰å¾…ç»“æœè¿”å›ï¼Œæ‰èƒ½ç»§ç»­è¿è¡Œå°±æ˜¯ **åŒæ­¥**
- ä¸éœ€è¦ç­‰å¾…ç»“æœè¿”å›ï¼Œå°±èƒ½ç»§ç»­è¿è¡Œå°±æ˜¯ **å¼‚æ­¥**

æ³¨ï¼šåŒæ­¥åœ¨å¤šçº¿ç¨‹ä¸­è¿˜æœ‰å¦å¤–ä¸€ä¸ªæ„æ€ï¼Œå°±æ˜¯è®©å¤šä¸ªçº¿ç¨‹æ­¥è°ƒä¸€è‡´


1ï¼‰è®¾è®¡
å¤šçº¿ç¨‹å¯ä»¥è®©æ–¹æ³•æ‰§è¡Œå˜æˆå¼‚æ­¥çš„ï¼ˆå³ä¸è¦ä¸€ç›´å¹²ç­‰ç€ï¼‰ã€‚æ¯”å¦‚è¯»å–ç£ç›˜æ–‡ä»¶æ—¶ï¼Œå‡è®¾è¯»å–æ“ä½œéœ€è¦èŠ±è´¹ 5sï¼Œå¦‚æœæ²¡æœ‰çº¿ç¨‹è°ƒåº¦æœºåˆ¶ï¼Œé‚£ä¹ˆè¿™ 5s è°ƒç”¨è€…å…¶ä»–çš„äº‹éƒ½åšä¸äº†ï¼Œå…¶ä½™ä»£ç éƒ½å¾—æš‚åœã€‚

2ï¼‰ç»“è®º
- åœ¨é¡¹ç›®ä¸­ï¼Œå¦‚æœéœ€è¦è¿›è¡Œä¸€äº›è´¹æ—¶æ“ä½œï¼Œæ¯”å¦‚è§†é¢‘æ–‡ä»¶éœ€è¦è½¬æ¢æ ¼å¼ç­‰æ“ä½œï¼Œè¿™æ—¶å¼€ä¸€ä¸ªæ–°çº¿ç¨‹å¤„ç†è§†é¢‘è½¬æ¢ï¼Œé¿å…é˜»å¡ä½ä¸»çº¿ç¨‹
- Tomcat çš„å¼‚æ­¥ Servlet ä¹Ÿæ˜¯ç±»ä¼¼çš„ç›®çš„ï¼Œè®©ç”¨æˆ·çº¿ç¨‹å¤„ç†è€—æ—¶è¾ƒé•¿çš„æ“ä½œï¼Œé¿å…é˜»å¡ Tomcat çš„å·¥ä½œçº¿ç¨‹ 
- UI ç¨‹åºä¸­ï¼Œå¼€çº¿ç¨‹è¿›è¡Œå…¶ä»–æ“ä½œï¼Œé¿å…é˜»å¡ UI çº¿ç¨‹

åŒæ­¥ç­‰å¾…
```java
@Slf4j(topic = "c.Sync")
public class Sync {
    public static void main(String[] args) {
        FileReader.read(Constants.MP4_FULL_PATH);  // åŒæ­¥è°ƒç”¨
        log.debug("do other things ...");
    }
}
```
å¼‚æ­¥ä¸ç­‰å¾…
```java
@Slf4j(topic = "c.Async")
public class Async {
    public static void main(String[] args) {
        // å¼‚æ­¥è°ƒç”¨
        new Thread(new Runnable() {
            public void run() {
                FileReader.read(Constants.MP4_FULL_PATH);
            }
        }).start();

        log.debug("do other things ...");
    }
}
```

---
**æé«˜è¿è¡Œæ•ˆç‡**

å……åˆ†åˆ©ç”¨å¤šæ ¸ cpu çš„ä¼˜åŠ¿ï¼Œæé«˜è¿è¡Œæ•ˆç‡ã€‚æƒ³è±¡ä¸‹é¢çš„åœºæ™¯ï¼šæ‰§è¡Œ 3 ä¸ªè®¡ç®—ï¼Œæœ€åå°†è®¡ç®—ç»“æœæ±‡æ€»ã€‚

>è®¡ç®— 1 èŠ±è´¹ 10 ms
>
>è®¡ç®— 2 èŠ±è´¹ 11 ms
>
>è®¡ç®— 3 èŠ±è´¹ 9 ms
>
>æ±‡æ€»éœ€è¦ 1 ms

- å¦‚æœæ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆæ€»å…±èŠ±è´¹çš„æ—¶é—´æ˜¯ 10 + 11 + 9 + 1 = 31ms 
- ä½†å¦‚æœæ˜¯å››æ ¸ cpuï¼Œå„ä¸ªæ ¸å¿ƒåˆ†åˆ«ä½¿ç”¨çº¿ç¨‹ 1 æ‰§è¡Œè®¡ç®— 1ï¼Œçº¿ç¨‹ 2 æ‰§è¡Œè®¡ç®— 2ï¼Œçº¿ç¨‹ 3 æ‰§è¡Œè®¡ç®— 3ï¼Œé‚£ä¹ˆ 3 ä¸ª çº¿ç¨‹æ˜¯å¹¶è¡Œçš„ï¼ŒèŠ±è´¹æ—¶é—´åªå–å†³äºæœ€é•¿çš„é‚£ä¸ªçº¿ç¨‹è¿è¡Œçš„æ—¶é—´ï¼Œå³ 11msæœ€ååŠ ä¸Šæ±‡æ€»æ—¶é—´åªä¼šèŠ±è´¹ 12ms 
- éœ€è¦åœ¨å¤šæ ¸ cpu æ‰èƒ½æé«˜æ•ˆç‡ï¼Œå•æ ¸ä»ç„¶æ˜¯è½®æµæ‰§è¡Œã€‚


---

## åˆ›å»ºä¸è¿è¡Œçº¿ç¨‹

### ä½¿ç”¨Thread

>Java ç¨‹åºåœ¨å¯åŠ¨æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªä¸»æ–¹æ³•çº¿ç¨‹ï¼ˆä¹Ÿç§°ï¼šä¸»çº¿ç¨‹ï¼‰ã€‚é»˜è®¤å°±å·²ç»æœ‰ä¸€ä¸ªä¸»çº¿ç¨‹åœ¨è¿è¡Œã€‚
```java
// åˆ›å»ºçº¿ç¨‹å¯¹è±¡
Thread t = new Thread("t1") {
    @Override
    public void run() {
        // è¦æ‰§è¡Œçš„ä»»åŠ¡
    }
};
// å¯åŠ¨çº¿ç¨‹
t.start();
```

æŒ‡å®šåç§°
```java
@Slf4j(topic = "c.Test1")
public class DirectUseThreadTest {
    public static void main(String[] args) {
        // åˆ›å»ºçº¿ç¨‹
        Thread t1 = new Thread("t1") {  // æŒ‡å®šåç§°ï¼ˆæ–¹å¼ä¸€ï¼‰
            @Override
            public void run() {
                log.debug("running ...");
            }
        };

        t1.setName("t1");  // æŒ‡å®šåç§°ï¼ˆæ–¹å¼äºŒï¼‰

        // å¯åŠ¨çº¿ç¨‹
        t1.start();

        // ä¸»çº¿ç¨‹æ‰“å°
        log.debug("running ...");
    }
}
```

Lambdaå†™æ³•
```java
@Slf4j
public class ThreadDemo {
    public static void main(String[] args) {
        new Thread(() -> {
            log.info("running");
        }, "t1").start();

        log.info("main");
    }
}
```


### ä½¿ç”¨Runableé…åˆThread
æŠŠã€çº¿ç¨‹ã€‘å’Œã€ä»»åŠ¡ã€‘(è¦æ‰§è¡Œçš„ä»£ç ) åˆ†å¼€
- Thread ä»£è¡¨çº¿ç¨‹
- Runnable ä»£è¡¨å¯è¿è¡Œçš„ä»»åŠ¡ï¼ˆçº¿ç¨‹è¦æ‰§è¡Œçš„ä»£ç ï¼‰

è¯­æ³•ï¼š
```java
Runnable runnable = new Runnable() {
    @Override
    public void run() {
        // è¦æ‰§è¡Œçš„ä»»åŠ¡
    }
};
// åˆ›å»ºçº¿ç¨‹å¯¹è±¡
Thread t = new Thread(runnable);
// å¯åŠ¨çº¿ç¨‹
t.start();
```

```java
// åˆ›å»ºä»»åŠ¡å¯¹è±¡
Runnable task2 = new Runnable() {
    @Override
    public void run() {
        log.debug("hello");
    }
};

// å‚æ•°1 æ˜¯ä»»åŠ¡å¯¹è±¡; å‚æ•°2 æ˜¯çº¿ç¨‹åå­—
Thread t2 = new Thread(task2, "t2");
t2.start();
```

lambdaè¡¨è¾¾å¼:
```java
// åˆ›å»ºä»»åŠ¡å¯¹è±¡
Runnable task2 = () -> log.debug("hello");

// å‚æ•°1 æ˜¯ä»»åŠ¡å¯¹è±¡; å‚æ•°2 æ˜¯çº¿ç¨‹åå­—ï¼Œæ¨è
Thread t2 = new Thread(task2, "t2");
t2.start();



public static void test2() {
    Runnable runnable = () -> log.info("runnable running");
    new Thread(runnable, "t2").start();
}
```

åŸç† â€”â€” Thread ä¸ Runnable çš„å…³ç³»

Thread æ ¸å¿ƒæºç 
```java
private Runnable target;

@Override
public void run() {
    if (target != null) {
        target.run();
    }
}
```
å®é™…ï¼Œå°±æ˜¯åœ¨ Thread ä¸­çš„ run æ–¹æ³•é‡Œé¢è°ƒç”¨äº† Runnable æ–¹æ³•çš„ run æ–¹æ³•æ¥æ‰§è¡Œä»»åŠ¡ã€‚

- ç¬¬ä¸€ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•æ˜¯æŠŠçº¿ç¨‹å’Œä»»åŠ¡çš„åˆ›å»ºåˆå¹¶åœ¨äº†ä¸€èµ·ï¼Œç¬¬äºŒç§åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•æ˜¯æŠŠçº¿ç¨‹å’Œä»»åŠ¡åˆ†å¼€åˆ›å»ºäº† 
- ç”¨ Runnable æ›´å®¹æ˜“ä¸çº¿ç¨‹æ± ç­‰é«˜çº§ API é…åˆ 
- ç”¨ Runnable è®©ä»»åŠ¡ç±»è„±ç¦»äº† Thread ç»§æ‰¿ä½“ç³»ï¼Œæ›´çµæ´»

### FutureTaské…åˆThread

FutureTaskèƒ½å¤Ÿæ¥æ”¶Callableç±»å‹çš„å‚æ•°ï¼Œç”¨æ¥**å¤„ç†æœ‰è¿”å›ç»“æœçš„æƒ…å†µ**ã€‚

```java
@Slf4j(topic = "c.Test3")
public class FutureAndCallableTest {
    public static void main(String[] args) throws ExecutionException, InterruptedException {
        // 1.åˆ›å»ºä»»åŠ¡å¯¹è±¡
        FutureTask<Integer> task = new FutureTask<>(new Callable<>() {
            @Override
            public Integer call() throws Exception {
                log.debug("running ...");
                Thread.sleep(4000);
                return 100;
            }
        });

        // 2.åˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œå¹¶å…³è”ä»»åŠ¡
        Thread t = new Thread(task, "t3");

        t.start();

        // ä¸»çº¿ç¨‹è¿è¡Œåˆ°æ­¤å¤„æ—¶ï¼Œå°±ä¼šä¸€ç›´é˜»å¡ã€‚ç›´åˆ° task æ‰§è¡Œå®Œæ¯•åè¿”å›ç»“æœ
        log.debug("{}",  task.get());
    }
}
```

```
11:46:34.082 c.Test3 [t3] - running ...
11:50:35.093 c.Test3 [main] - 100
```

lambda:
```java
    public static void main(String[] args) throws ExecutionException, InterruptedException {
        FutureTask<Integer> task = new FutureTask<>(() -> {
            TimeUnit.SECONDS.sleep(1);
            log.info("running...");
            return 100;
        });
        new Thread(task, "t1").start();
        Integer i = task.get();
        log.info("i:{}", i);
    }
```


## æŸ¥çœ‹è¿›ç¨‹çº¿ç¨‹çš„æ–¹æ³•

Windows
- ä»»åŠ¡ç®¡ç†å™¨å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å’Œçº¿ç¨‹æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ€æ­»è¿›ç¨‹
- `tasklist` æŸ¥çœ‹è¿›ç¨‹
- `taskkill` æ€æ­»è¿›ç¨‹

linux
- `ps -ef` æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
- `ps -fT -p <PID>` æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ï¼ˆPIDï¼‰çš„æ‰€æœ‰çº¿ç¨‹
- `kill` æ€æ­»è¿›ç¨‹
- `top` æŒ‰å¤§å†™ H åˆ‡æ¢æ˜¯å¦æ˜¾ç¤ºçº¿ç¨‹
- `top -H -p <PID>` æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ï¼ˆPIDï¼‰ä¸­çš„æ‰€æœ‰çº¿ç¨‹

Java
- `jps` å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰ Java è¿›ç¨‹
- `jstack <PID>` æŸ¥çœ‹æŸä¸ª Java è¿›ç¨‹ï¼ˆPIDï¼‰åœ¨è¿è¡Œ jstack æ—¶çš„æ‰€æœ‰çº¿ç¨‹çŠ¶æ€
- `jconsole` æ¥æŸ¥çœ‹æŸä¸ª Java è¿›ç¨‹ä¸­çº¿ç¨‹çš„è¿è¡Œæƒ…å†µï¼ˆå›¾å½¢ç•Œé¢ï¼‰